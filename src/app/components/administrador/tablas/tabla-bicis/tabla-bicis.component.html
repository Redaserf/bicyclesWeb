<div class="container">
  <!-- TABLA 2: BICICLETAS -->
  <div class="panel">
    <div class="panel-heading">
      <h2 class="panel-title">Bicicletas</h2>
    </div>
    <div class="panel-body">
      <div class="table-responsive">
        <table mat-table [dataSource]="dataSource" matSort class="mat-elevation-z8">

          <!-- Columna Acciones -->
          <ng-container matColumnDef="acciones">
            <th mat-header-cell *matHeaderCellDef class="col-header">Acciones</th>
            <td mat-cell *matCellDef="let bici">
              <ul class="action-list">
                <li>
                  <a (click)="openModalEditar(bici)">
                    <i class="fa fa-edit"></i> Editar
                  </a>
                </li>
                <li>
                  <a (click)="openModalEliminar(bici)">
                    <i class="fa fa-trash"></i> Eliminar
                  </a>
                </li>
              </ul>
            </td>
          </ng-container>

          <!-- Columna Nombre -->
          <ng-container matColumnDef="nombre">
            <th mat-header-cell *matHeaderCellDef mat-sort-header class="col-header">Nombre</th>
            <td mat-cell *matCellDef="let bici"> {{ bici.nombre }} </td>
          </ng-container>

          <!-- Columna Usuario -->
          <ng-container matColumnDef="usuario">
            <th mat-header-cell *matHeaderCellDef mat-sort-header class="col-header">Usuario</th>
            <td mat-cell *matCellDef="let bici">
              {{ bici.usuario.nombre + ' ' + bici.usuario.apellido }}
            </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        </table>
      </div>
    </div>
  </div>
</div>

<!-- Fondo oscuro para el modal -->
<div #overlay id="modalOverlay" class="overlay" (click)="cerrarModal()"></div>

<!-- Modal Editar Bicicleta -->
<div #modalEditar class="modal-overlay">
  <div class="modal-content">
    <h2>Editar Bicicleta</h2>
    <input *ngIf="bicicletaSeleccionada" type="text" [(ngModel)]="nuevoNombre" class="modal-input" />
    <small class="text-danger" *ngIf="errores?.nombre">
      {{ errores.nombre[0] }}
    </small>
    <div class="modal-buttons">
      <button class="cancel-btn" (click)="cerrarModal()">Cancelar</button>
      <button class="confirm-btn" (click)="editarBicicleta()" [disabled]="isLoading">
        <span *ngIf="isLoading" class="spinner"></span>
        Guardar
      </button>
    </div>
  </div>
</div>

<!-- Modal Eliminar Bicicleta -->
<div #modalEliminar class="modal-overlay">
  <div class="modal-content">
    <h2>¿Eliminar Bicicleta?</h2>
    <p class="modal-text">¿Estás seguro de que quieres eliminar esta bicicleta?</p>
    <div class="modal-buttons">
      <button #cancelar class="cancel-btn" (click)="cerrarModal()">Cancelar</button>
      <button #guardar class="confirm-btn" (click)="eliminarBicicleta()" [disabled]="isLoading">
        <span *ngIf="isLoading" class="spinner"></span>
        Eliminar
      </button>
    </div>
  </div>
</div>
